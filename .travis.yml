# Framewor for testing web aplications - proof of concept
# Authors:  Roman Vais <rvais@redhat.com>
#
# This is configuration file for Travis CI

dist: trusty
sudo: required

addons:
  chrome: stable  # get stable version of chrome

language: python
python:
  - "3.6"

# before_install:
#  - 

install:
  # get chrome webdriver
  - wget -N http://chromedriver.storage.googleapis.com/2.30/chromedriver_linux64.zip -P ~/
  - unzip ~/chromedriver_linux64.zip -d ~/
  - rm ~/chromedriver_linux64.zip
  - sudo mv -f ~/chromedriver /usr/local/share/
  - sudo chmod +x /usr/local/share/chromedriver
  - sudo ln -s /usr/local/share/chromedriver /usr/local/bin/chromedriver

  # instal necessary modules for python
  - pip install -Ur requirements.txt

before_script: 
  # fake display for browser
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start

  # setup browser settings for webtests
  - echo $(which google-chrome)
  - echo $(which chromedriver)
  - export BROWSER_BIN_PATH=`readlink -f $(which google-chrome)`
  - export DRIVER_BIN_PATH=`readlink -f $(which chromedriver)`
  - export PYTHONPATH="${PWD%/}${PYTHONPATH:+:}${PYTHONPATH:-}"
  - cd webtest

script:
  -  python runner.py -b chrome -g "examples" -e "Google Search" -c ./webtest.cfg -l TRACE
 
